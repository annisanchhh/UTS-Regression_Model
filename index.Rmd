---
title: "My document"
date: "`r Sys.Date()`"
author: Annisa Nur Cahyani-Institut Teknologi Statistika dan Bisnis Muhammadiyah Semarang
output:
  rmdformats::readthedown:
    self_contained: true
    thumbnails: true
    lightbox: true
    gallery: false
    highlight: tango
bibliography: references.bib
---

```{=html}
<style>
body{
text-align: justify}
</style>
```
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# UTS-Regression Model 

## Soal 1
Langkah 1 Buat Correlation Matrix
```{r}
library(ggplot2)
library(corrplot)
library(readr)
library(dplyr)

# 2. Baca data utama
data <- read_csv("HeatingOil.csv")

# 3. Buat Correlation Matrix dan visualisasinya (Langkah 1)
cor_matrix <- cor(data)
print(cor_matrix)
corrplot(cor_matrix, method = "color", addCoef.col = "black", tl.cex = 0.8)
```

Langkah 2 Interpretasi Correlation Matrix

![correlation matrix](matriks.png)


Berdasarkan matriks korelasi, variabel yang memiliki hubungan kuat dengan Heating_Oil adalah:

1. Avg_Age memiliki korelasi positif sangat kuat sebesar +0.85. Ini menunjukkan bahwa rumah dengan penghuni lebih tua cenderung lebih banyak menggunakan Heating_Oil.

2. Temperature memiliki korelasi negatif kuat sebesar -0.77, artinya saat suhu lingkungan lebih tinggi, konsumsi Heating_Oil menurun.

3. Insulation menunjukkan korelasi positif kuat sebesar +0.74, meskipun secara logika seharusnya berkorelasi negatif. Ini bisa terjadi karena representasi nilai isolasi dalam data justru berbanding terbalik dengan kualitas isolasi.

4. Variabel lain seperti Num_Occupants memiliki korelasi yang sangat lemah (-0.04), sehingga tidak dianggap signifikan dalam analisis ini.

Kesimpulan
Faktor yang paling memengaruhi konsumsi Heating_Oil dalam data ini adalah:

1. Usia penghuni rumah (Avg_Age)

2. Suhu lingkungan (Temperature)

3. Ukuran rumah (Home_Size)

Langkah 3: Scatter Plot 1
Plot ini dibuat untuk melihat apakah terdapat hubungan antara **usia rata-rata penghuni rumah** (`Avg_Age`) dengan **jumlah konsumsi minyak pemanas** (`Heating_Oil`). Warna titik digunakan untuk menunjukkan intensitas konsumsi Heating_Oil, dari biru (rendah) ke merah (tinggi).

```{r}
# 5. Scatter Plot 1: Heating_Oil vs Avg_Age (Langkah 3)
ggplot(data, aes(x = Heating_Oil, y = Avg_Age, color = Heating_Oil)) +
  geom_point() +
  scale_color_gradient(low = "blue", high = "red") +
  theme_minimal() +
  labs(title = "Heating Oil vs Avg Age", x = "Heating Oil", y = "Avg Age")

```

Terdapat hubungan yang cukup kuat antara usia rata-rata penghuni rumah dan jumlah konsumsi Heating_Oil. Visualisasi ini mendukung hasil correlation matrix sebelumnya (dengan nilai korelasi sekitar +0.85) dan memperkuat dugaan bahwa faktor demografis seperti usia dapat memengaruhi kebiasaan konsumsi energi rumah tangga.

Langkah 4: Scatter Plot 2
```{r}
# 6. Scatter Plot 2: Temperature vs Insulation (warna berdasarkan Heating_Oil) (Langkah 4)
ggplot(data, aes(x = Temperature, y = Insulation, color = Heating_Oil)) +
  geom_point() +
  scale_color_gradient(low = "green", high = "red") +
  theme_minimal() +
  labs(title = "Temperature vs Insulation (colored by Heating Oil)", x = "Temperature", y = "Insulation")

```




# Referensi
